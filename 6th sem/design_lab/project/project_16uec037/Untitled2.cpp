
    j=0;
    for(int i=0; i<n/6; i++)
    {
        if(xnewre[i]==-7&&xnewim[i]==7)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=0;
        }
        else if(xnewre[i]==-5&&xnewim[i]==7)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=1;
        }
        else if(xnewre[i]==-3&&xnewim[i]==7)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=1;
        }
        else if(xnewre[i]==-1&&xnewim[i]==7)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=0;
        }
        else if(xnewre[i]==1&&xnewim[i]==7)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=0;
        }
        else if(xnewre[i]==3&&xnewim[i]==7)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=1;
        }
        else if(xnewre[i]==5&&xnewim[i]==7)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=1;
        }
        else if(xnewre[i]==7&&xnewim[i]==7)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        else if(xnewre[i]==-7&&xnewim[i]==5)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        
        
        else if(xnewre[i]==-5&&xnewim[i]==5)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==-3&&xnewim[i]==5)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==-1&&xnewim[i]==5)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==1&&xnewim[i]==5)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==3&&xnewim[i]==5)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==5&&xnewim[i]==5)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==7&&xnewim[i]==5)
        {
            final[j]=0;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==-7&&xnewim[i]==3)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        else if(xnewre[i]==-5&&xnewim[i]==3)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=1;
        }
        else if(xnewre[i]==-3&&xnewim[i]==3)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==-1&&xnewim[i]==3)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=0;
        }
        else if(xnewre[i]==1&&xnewim[i]==3)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        else if(xnewre[i]==3&&xnewim[i]==3)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=1;
        }
        else if(xnewre[i]==5&&xnewim[i]==3)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        else if(xnewre[i]==7&&xnewim[i]==3)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        else if(xnewre[i]==-7&&xnewim[i]==1)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==-5&&xnewim[i]==1)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        
        
        else if(xnewre[i]==-3&&xnewim[i]==1)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        else if(xnewre[i]==-1&&xnewim[i]==1)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        
        
        
        else if(xnewre[i]==1&&xnewim[i]==1)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==3&&xnewim[i]==1)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==5&&xnewim[i]==1)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==7&&xnewim[i]==1)
        {
            final[j]=0;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=0;
        }
        
    
        
        else if(xnewre[i]==-7&&xnewim[i]==-7)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=0;
        }
        else if(xnewre[i]==-5&&xnewim[i]==-7)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=1;
        }
        else if(xnewre[i]==-3&&xnewim[i]==-7)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=1;
        }
        else if(xnewre[i]==-1&&xnewim[i]==-7)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=0;
        }
        else if(xnewre[i]==1&&xnewim[i]==-7)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=0;
        }
        else if(xnewre[i]==3&&xnewim[i]==-7)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=1;
        }
        else if(xnewre[i]==5&&xnewim[i]==-7)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=1;
        }
        else if(xnewre[i]==7&&xnewim[i]==-7)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        else if(xnewre[i]==-7&&xnewim[i]==-5)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        
        
        else if(xnewre[i]==-5&&xnewim[i]==-5)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==-3&&xnewim[i]==-5)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==-1&&xnewim[i]==-5)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==1&&xnewim[i]==-5)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==3&&xnewim[i]==-5)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==5&&xnewim[i]==-5)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==7&&xnewim[i]==-5)
        {
            final[j]=1;
            final[j+1]=0;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==-7&&xnewim[i]==-3)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        else if(xnewre[i]==-5&&xnewim[i]==-3)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=1;
        }
        else if(xnewre[i]==-3&&xnewim[i]==-3)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==-1&&xnewim[i]==-3)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=0;
        }
        else if(xnewre[i]==1&&xnewim[i]==-3)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        else if(xnewre[i]==3&&xnewim[i]==-3)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=1;
        }
        else if(xnewre[i]==5&&xnewim[i]==-3)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        else if(xnewre[i]==7&&xnewim[i]==-3)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=1;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        else if(xnewre[i]==-7&&xnewim[i]==-1)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==-5&&xnewim[i]==-1)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        
        
        else if(xnewre[i]==-3&&xnewim[i]==-1)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        else if(xnewre[i]==-1&&xnewim[i]==-1)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=0;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        
        
        
        else if(xnewre[i]==1&&xnewim[i]==-1)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=0;
        }
        
        
        else if(xnewre[i]==3&&xnewim[i]==-1)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=1;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==5&&xnewim[i]==-1)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=1;
        }
        
        
        else if(xnewre[i]==7&&xnewim[i]==-1)
        {
            final[j]=1;
            final[j+1]=1;
            final[j+2]=0;
            final[j+3]=1;
            final[j+4]=0;
            final[j+5]=0;
        }
        j=j+6;
    }

    
    int reconst[1024];
    int z=0;
    long int m=0;
    for(int i=0; i<1024*8; )
    {
        for(int k=0; k<8; k++)
        {
            int p=final[i+k];
            m+=p*pow(10,7-k);
        
        }
            int rep=binaryToDecimal(m);
            reconst[z++]=rep;
        m=0;
        i=i+8;
    }
    
    char reconstim[1024];
    for(int i=0; i<1024;i++)
    {
        reconstim[i]=char(reconst[i]-128);
        //cout<<(reconst[i])<<" "<<(buffer1[i])<<"\n";
    }
    
    
    
    
    
    out = fopen("out.bmp","wb"); 
    for(int i=0; i<1024; i++)
    {
        fputc((reconst[i])-128,out);
    }
    
  return 0; 
}
